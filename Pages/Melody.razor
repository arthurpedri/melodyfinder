@page "/melody"
@inject IJSRuntime JS

<h3>Melody Generator</h3>

<!-- <button @onclick="GenerateMelody">Generate</button> -->
<button @onclick="PlayMelody" >Play</button>

<h3 id="score-info" >Score Information: @(abc.Split('\n')[4])</h3>

<div id="notation"></div>
<div id="audio-controls"></div>

@code {
    // As stated, immediately following the K: field on the next line is the body of the tune, eg the representation of the notes of the melody.
    string abc = "X:1\nQ:80\nT:Simple Scale\nM:4/4\nK:G\n[C2E2G2][D2F2A2][GBd][FAd][E2G2B2]||";

// TODO: Create method to generate chord progressions based on common progressions and randomize the key


    bool generated = false;

    async Task GenerateMelody()
    {
        await JS.InvokeVoidAsync("musicInterop.renderABC", "notation", abc);
        generated = true;
    }

    async Task PlayMelody()
    {
        await JS.InvokeVoidAsync("musicInterop.playABC", abc);
    }
}
